## **The bilateral flows ratio model**

### **General model assumptions**

<p>The bilateral migration flows ratios are constructed by taking flows from country <span class="math inline">\(X\)</span> to a group of high data-quality countries reported by country <span class="math inline">\(X\)</span> and dividing it by the same flow reported by the the reference countries. As a default set of the reference countries we selected the Nordic countries (Denmark, Finland, Sweden, Norway, and Iceland), Belgium, the Netherlands, and Switzerland. These countries had the lowest undercounting according to IMEM and metadata as well as consistently low undercounting for the various options tested in our model. Because the minimal duration of stay required for the definition of an international migration may differ from country to country, flows reported by each country need to be adjusted accordingly.</p>

<p>Formally, the undercounting ratio <span class="math inline">\(U^E_{X,Y,t}\)</span> for emigration data between country <span class="math inline">\(X\)</span> and set of countries <span class="math inline">\(Y\)</span> in year <span class="math inline">\(t\)</span>, can be defined as follows: <span class="math display">\[\begin{equation}
   U^E_{X,Y,t} = \frac{\sum_c M\left(X_t\rightarrow Y_{c,t}, X_t\right) R_{X_t}}{\sum_{c} M\left(X_t\rightarrow Y_{c,t}, Y_{c,t}\right) R_{Y_{c,t}}}, 
\end{equation}\]</span> where <span class="math inline">\(M\left(X_t\rightarrow Y_{c,t}, X_t\right)\)</span> is the emigration flow from country <span class="math inline">\(X\)</span> to country <span class="math inline">\(Y_c\)</span> reported by country <span class="math inline">\(X\)</span> in year <span class="math inline">\(t\)</span>, <span class="math inline">\(M\left(X_t\rightarrow Y_{c,t}, Y_{c,t}\right)\)</span> is the immigration flow from country <span class="math inline">\(X\)</span> to country <span class="math inline">\(Y_c\)</span> reported by country <span class="math inline">\(Y_c\)</span> in year <span class="math inline">\(t\)</span>, <span class="math inline">\(R_{X_t}\)</span> is the correction for duration of stay of country <span class="math inline">\(X\)</span> in year <span class="math inline">\(t\)</span>, and <span class="math inline">\(R_{Y_{c,t}}\)</span> is the correction for duration of stay of country <span class="math inline">\(Y_c\)</span> reported in year <span class="math inline">\(t\)</span>. The immigration bilateral flows ratios are calculated analogically.</p>

### **Duration of stay correction coefficients**

<div label ="duration">
<p>The correction coefficients are a set of parameters that monotonically increase with the duration of stay. They were found by minimizing under-counting in the entire set of EU countries in the years 2002-2019. We consider two optional minimization criteria: multiplicative <span class="math inline">\(\sum_{X,Y,t}|log M\left(X_t\rightarrow Y_{c,t}, X_t\right) / M\left(X_t\rightarrow Y_{c,t}, Y_{c,t}\right)|\)</span> and additive (default in the app) <span class="math inline">\(\sum_{X,Y,t} (M\left(X_t\rightarrow Y_{c,t}, X_t\right) - M\left(X_t\rightarrow Y_{c,t}, Y_{c,t}\right))^2\)</span>. The latter option seems to be the most useful as it is more sensitive to the magnitude of the flow differences. The coefficients can be estimated both jointly or separately for each of the two types of migration. Alternatively, correction coefficients can be taken directly from the previous models such as IMEM model (Raymer et al. 2013) or other models summarized in the Willekens (2019) paper.</p>
</div>

### **Bilateral flows ratios and their confidence intervals for year-specific model**

The probability $P^E_{X,Y,y}$ of emigration form country $X$ to a group of countries $Y$ in year $y$ can be defined as
$$ P^E_{X,Y,y} = \frac{M\left(X_y\rightarrow Y_y\right)}{M\left(X_y\rightarrow \Omega_y\right)},$$
where $M\left(X/-y\rightarrow \Omega\right)$ is the total emigration counts of country $X$. The probability $P^I_{X,Y,y}$ of immigration flow to country $X$ from country $Y$ is defined analogically. 

We can simulate the migration process by drawing the number of migration events $m\left(X_y\rightarrow Y_y\right)$ in year $y$ from the binomial distribution $B(n, p)$, where $n = M\left(X_y\rightarrow \Omega\right)$ is a number of trials and $p = P_{X,Y,y}$ is a probability of success on each trial, hence $\mathbb{E}(m) = M\left(X_y\rightarrow Y_y\right)$

As defined in previous section $U^E_{X,Y,y}$ and $U^I_{X,Y,y}$ are ratios of two independent migration processes therefore each of these migration processes can be simulated independently as described above. 100,000 of simulations defines a bootstrap sample that is used to calculate bootstrapped 95% confidence intervals (percentile method, e.g., Efron and Tibshirani 1993) and standard deviations of the ratio. 

### **Obtaining normalized undercounting scores**

<p>Since bilateral flow ratios (quotients) are placed on the multiplicative scale, it is convenient to refer to their logarithms. The logarithm of bilateral flows ratios adjusted for duration of stay ranges from - <span class="math inline">\(\infty\)</span> to + <span class="math inline">\(\infty\)</span>. Values greater than 0 are considered overcounted, 0 means no undercounting or overcounting problems, and negative values represent undercounting. These values should be projected to a discrete 0-1 scale to be useful from a modeling perspective. For modeling flexibility, we use categorizations based on evenly spaced thresholds or quantiles (default). The projection is not trivial as potential overcounting problems often arise. The term “potential” requires some explanation. If the reference countries’ data are of perfect quality (i.e., there is no undercounting or overcounting) and the assumed duration-of-stay coefficients perfectly adjust flows to the 12-month criterion, overcounting will be clearly outlined. However, this scenario is unlikely, so the overcounting class can be a mix of overcounitng and undercounting. We propose two options for solving this problem: (1) combining the overcounting class with the lowest undercounting class or (2) treating overcounting as a separate class. The obtained results can be used directly in migration models or after numerical representation combined with expertise and metadata scores.</p>

### **Combining multiple source of information on undercounting**

<p>The procedure for linking undercounting from different sources requires a numerical representation of the obtained results / classifications in the range 0 to 1. The score for IMEM is simply 0 for low undercounting and 1 for high undercounting. The immigration metadata only contains information about the registration obligation and incomplete information about time limits and sanctions for non-registration. We assumed that countries without the obligation to register receive a score of 1 (high undercounting), otherwise 0, however in the absence of a time limit or when there are no sanctions, the score changes to 0.5 (average undercounting). The emigration metadata score is calculated as a weighted average with arbitrary (default) weights: 50% for the de-registration obligation, 30% for the presence of administrative corrections and 10% each for the obligation to register and monitor third-country nationals. We set small weights for the two later cases as third country nationals are not currently included in our models.</p>

<p>The obtained scores from different sources can be combined using weighted average. As previously mentioned, after 2007 there was a significant breakthrough in migration data collection due to the harmonization of the definition of the duration of stay (Reg. (EC) 862/2007) and possibility of using censuses that took place in subsequent years to update migration estimates. For this reason, we decided to split the contribution of expert opinion, metadata, and model into two periods, namely, before 2008 and after 2007. This cut-off is defined by a threshold parameter (2008, by default). We used the same weights for immigration and emigration (by default) that for the first period (before 2008) were arbitrarily set to 20% for the IMEM score, 10% for the metadata score, and 70% for the model score, from 2008 onward, the weight of the metadata remained at 10%, the weight for the IMEM score decreased to 10%, and the model score increased to 70%. We chose rather low weights for the metadata because off its limited availability. In the future, as we plan to directly collect more precise metadata from the NSOs, these weights might increase. We also decreased the IMEM weights in the second period, because the IMEM classification focuses on the years prior to 2008 years and may not be relevant anymore for more recent years. Ultimately, the obtained numerical results can be divided (equally spaced thresholds) into a variable of 2, 3 or more (up to 7 in the app) levels. The Shiny app  offers huge flexibility in setting all mentioned parameters.</p>

### **References**

<a href="https://www.tandfonline.com/doi/abs/10.1080/01621459.2013.789435?journalCode=uasa20">Raymer, J., Wiśniowski, A., Forster, J. J., Smith, P. W. F., and Bijak, J. (2013), ‘Integrated Modeling of European Migration’, Journal of the American Statistical Association 108(503), 801–819.</a>

<a href="https://sciendo.com/article/10.2478/jos-2019-0011"> Willekens, F. (2019), 'Evidence-Based Monitoring of International Migration Flows in Europe'. Journal of Official Statistics, Vol.35 (Issue 1), pp. 231-277.</a>

<a href="https://books.google.de/books/about/An_Introduction_to_the_Bootstrap.html?id=gLlpIUxRntoC&redir_esc=y">Efron, B. and Tibshirani, R.J. (1993), 'An introduction to the bootstrap'. Taylor & Francis. ISBN: 0412-04231-2.</a>
